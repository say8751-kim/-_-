# -_-
# 2025-1í•™ê¸° ì¸ê³µì§€ëŠ¥ ê°•ì¢Œ FINAL PROJECT  
---

## ì£¼ì œ ì„ ì •
ì£¼ì œ: fetal ultrasound image segmentation  
ì„ ì • ë°°ê²½: ì´ˆìŒíŒŒ ì˜ìƒì˜ ê²½ìš° ì„ìƒ ê²½í—˜ì´ ë§ì´ ìŒ“ì´ì§€ ì•Šì€ ê°„í˜¸, ì˜ëŒ€ ì‹¤ìŠµìƒì˜ ê²½ìš° ë¶€ìœ„ íŒë³„ì— ì–´ë ¤ì›€ì„ ë§ì´ ê²ªëŠ” í¸ì´ë¼ê³  í•œë‹¤.(ìë£Œ ì²¨ë¶€ ì˜ˆì •) íŠ¹íˆ ê·¸ì¤‘ íƒœì•„ ì´ˆìŒíŒŒ ì˜ìƒì˜ ê²½ìš° ì‹¤ìŠµ ì¤‘ì—” ë”ë”ìš± ì ‘í•˜ê¸° í˜ë“  ê²ƒì´ í˜„ì‹¤ì´ë‹¤. ë”°ë¼ì„œ ì‹¤ìŠµìƒë“¤ì˜ êµìœ¡ì„ ë•ê¸° ìœ„í•œ image segmentation ëª¨ë¸ì´ ìˆë‹¤ë©´ ë„ì›€ì´ ë  ê²ƒì´ë¼ê³  íŒë‹¨, í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ê²Œ ë˜ì—ˆë‹¤.  

---

## ì‚¬ìš© ëª¨ë¸: UNET  
ì¢‹ì€ ì„ íƒì´ì—ìš”! íƒœì•„ ë¨¸ë¦¬ ì´ˆìŒíŒŒ ì˜ìƒ ë°ì´í„°ì…‹ê³¼ UNetì€ ì˜ë£Œì˜ìƒ ë¶„ì•¼ì—ì„œ ì •ë§ ì˜ ë§ëŠ” ì¡°í•©ì…ë‹ˆë‹¤. ì•„ë˜ì— ì„¤ëª…ë“œë¦´ê²Œìš”.  
### ğŸ§  1. **ì´ ë°ì´í„°ì…‹ìœ¼ë¡œ ë§Œë“¤ ìˆ˜ ìˆëŠ” ë”¥ëŸ¬ë‹ ëª¨ë¸ ì˜ˆì‹œ**

ë‹¹ì‹ ì€ ì´ ë°ì´í„°ì…‹ì„ í†µí•´ **ì˜ë£Œì˜ìƒ ë¶„í• (segmentation)** ê¸°ë°˜ì˜ ë”¥ëŸ¬ë‹ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•  ìˆ˜ ìˆì–´ìš”. íŠ¹íˆ **UNet**ì€ ì´ ì‘ì—…ì— ìµœì í™”ëœ êµ¬ì¡°ì…ë‹ˆë‹¤.

#### âœ… ì˜ˆì‹œ í”„ë¡œì íŠ¸ ì£¼ì œ

**"UNet ê¸°ë°˜ì˜ íƒœì•„ ë‡Œ êµ¬ì¡° ë¶„í•  ëª¨ë¸ ê°œë°œ ë° ì„±ëŠ¥ í‰ê°€"**

##### â¤ ëª©í‘œ

* ì´ˆìŒíŒŒ ì˜ìƒì—ì„œ ë‡Œ(BRAIN), CSP, LV ê°™ì€ êµ¬ì¡°ë¥¼ ìë™ìœ¼ë¡œ ë¶„í• 
* ì •í™•ë„, IoU, Dice coefficient ë“± í‰ê°€ ì§€í‘œë¥¼ í™œìš©í•´ ì„±ëŠ¥ í‰ê°€

##### â¤ ê¸°ëŒ€ íš¨ê³¼

* ìë™í™”ëœ íƒœì•„ ìƒì²´ ê³„ì¸¡ ê°€ëŠ¥
* ì˜ë£Œì§„ì˜ ìˆ˜ì‘ì—… ë¶€ë‹´ ì™„í™” ë° ì§„ë‹¨ ì •í™•ë„ í–¥ìƒ

### ğŸ¥ 2. **ì˜ë£Œìš© ì¸ê³µì§€ëŠ¥ì—ì„œ UNetì€ ì™œ ìì£¼ ì“°ì¼ê¹Œ?**

UNetì€ 2015ë…„ ë°”ì´ì˜¤ë©”ë””ì»¬ ì´ë¯¸ì§€ ë¶„í• ì„ ìœ„í•´ ì œì•ˆëœ CNN ê¸°ë°˜ êµ¬ì¡°ì…ë‹ˆë‹¤. ì˜ë£Œì˜ìƒì— íŠ¹íˆ ì˜ ë§ëŠ” ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ì•„ìš”:

| íŠ¹ì§•                     | ì„¤ëª…                                |
| ---------------------- | --------------------------------- |
| **Encoder-Decoder êµ¬ì¡°** | ì»¨í…ìŠ¤íŠ¸ ì •ë³´ë¥¼ ì¶•ì†Œí•˜ë©° ì¶”ì¶œí•˜ê³ , í”½ì…€ ë‹¨ìœ„ ë³µì›ê¹Œì§€ ê°€ëŠ¥ |
| **Skip Connection**    | ì €ìˆ˜ì¤€ê³¼ ê³ ìˆ˜ì¤€ íŠ¹ì§•ì„ ê²°í•© â†’ ê²½ê³„ê°€ ëšœë ·í•œ ë¶„í•  ê°€ëŠ¥   |
| **ì†ŒëŸ‰ì˜ ë¼ë²¨ë§ ë°ì´í„°ì—ë„ ê°•ê±´í•¨**  | ì˜ë£Œ ë°ì´í„°ì…‹ì€ ëŒ€ì²´ë¡œ ì ì€ ì–‘ì´ë¯€ë¡œ ë§¤ìš° ì í•©        |

### ğŸ“Œ 3. **UNetì´ ì“°ì¸ ëŒ€í‘œì ì¸ ì˜ë£Œ AI ì—°êµ¬ ì‚¬ë¡€**

#### ğŸ©º (1) **Liver Tumor Segmentation (LiTS Challenge)**

* CT ì˜ìƒì—ì„œ ê°„ê³¼ ì¢…ì–‘ì„ ë¶„í• 
* UNet ë° ë³€í˜• ëª¨ë¸ë¡œ ì°¸ê°€ì ë‹¤ìˆ˜ ìˆ˜ìƒ

#### ğŸ§  (2) **Brain Tumor Segmentation (BraTS Challenge)**

* MRI ì˜ìƒì—ì„œ ë‡Œì¢…ì–‘ ë¶€ìœ„ë¥¼ í”½ì…€ ë‹¨ìœ„ë¡œ ë¶„í• 
* UNet ë³€í˜• (3D UNet, Attention UNet ë“±)ì´ ì£¼ë ¥ìœ¼ë¡œ í™œìš©

#### ğŸ‘ (3) **Retinal Vessel Segmentation**

* ì•ˆì €(fundus) ì˜ìƒì—ì„œ í˜ˆê´€ êµ¬ì¡° ë¶„í• 
* UNetìœ¼ë¡œ í˜ˆê´€ ê²½ê³„ ì •ë°€ ë¶„í•  ê°€ëŠ¥

#### ğŸ©¸ (4) **Skin Lesion Segmentation**

* í”¼ë¶€ ë³‘ë³€ ìë™ ê²½ê³„ ì¶”ì¶œ (ISIC ë°ì´í„°ì…‹ ê¸°ë°˜)
* UNet ê¸°ë°˜ êµ¬ì¡°ê°€ ë‹¤ì–‘í•œ ë…¼ë¬¸ì— ì±„íƒë¨

### ğŸ’¡ Final Project ì œì•ˆ ìš”ì•½ (í•™ë¶€ìƒ ìˆ˜ì¤€ì—ì„œ ê°€ëŠ¥)

| í•­ëª©           | ì„¤ëª…                                                                          |
| ------------ | --------------------------------------------------------------------------- |
| **í”„ë¡œì íŠ¸ëª…**    | UNet ê¸°ë°˜ íƒœì•„ ë¨¸ë¦¬ ì´ˆìŒíŒŒ ì˜ìƒ ë¶„í•  ëª¨ë¸ ê°œë°œ                                               |
| **ì‚¬ìš© ë°ì´í„°**   | Large-Scale Annotation Dataset for Fetal Head Biometry in Ultrasound Images |
| **ëª©í‘œ**       | ë‡Œ(BRAIN), CSP, LV ì˜ì—­ ìë™ ë¶„í•                                                   |
| **í™œìš© ê¸°ìˆ **    | UNet, PyTorch or TensorFlow, Dice Loss, IoU, ì‹œê°í™” (Matplotlib or Streamlit)  |
| **ë³´ë„ˆìŠ¤ ì•„ì´ë””ì–´** | ì›ë³¸ ì´ë¯¸ì§€ë¡œ ë³µì›í•´ì„œ ì •í™•ë„ ë¹„êµ, ë‹¤ì–‘í•œ augmentation ê¸°ë²• ì‹¤í—˜ ë“±                               |


### ğŸ“˜ ë„ì›€ì´ ë  ìë£Œ

* ë…¼ë¬¸: [UNet: Convolutional Networks for Biomedical Image Segmentation (2015)](https://arxiv.org/abs/1505.04597)
* GitHub ì˜ˆì œ: `segmentation_models_pytorch` ë˜ëŠ” `keras-unet` ê°™ì€ ì˜¤í”ˆì†ŒìŠ¤ í™œìš© ê°€ëŠ¥


í”„ë¡œì íŠ¸ ì•„ì´ë””ì–´ë¥¼ êµ¬ì²´í™”í•´ë³´ê³  ì‹¶ë‹¤ë©´, ëª¨ë¸ ì•„í‚¤í…ì²˜ ì„¤ê³„ë‚˜ í•™ìŠµ ì½”ë“œ êµ¬ì¡°ë„ ë„ì™€ì¤„ ìˆ˜ ìˆì–´ìš”. ì–¸ì œë“ ì§€ ì§ˆë¬¸ ì£¼ì„¸ìš”!

---

## ì‚¬ìš© ë°ì´í„°ì…‹  
ë§í¬: https://zenodo.org/records/8265464  
ì´ ë°ì´í„°ì…‹ **Large-Scale Annotation Dataset for Fetal Head Biometry in Ultrasound Images**ëŠ” ì‚°ì „ ì§„ë‹¨ì— í™œìš©ë˜ëŠ” íƒœì•„ ë¨¸ë¦¬ ì´ˆìŒíŒŒ ì´ë¯¸ì§€ë¥¼ ê¸°ë°˜ìœ¼ë¡œ, **ê°ê´€ì ì´ê³  ì •ëŸ‰ì ì¸ ìƒì²´ ê³„ì¸¡ ì•Œê³ ë¦¬ì¦˜ ì—°êµ¬ë¥¼ ì§€ì›**í•˜ê¸° ìœ„í•´ êµ¬ì¶•ëœ ê³µê°œ ì˜ë£Œì˜ìƒ ë°ì´í„°ì…‹ì…ë‹ˆë‹¤. ì£¼ìš” íŠ¹ì§•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

### ğŸ” **ê¸°ë³¸ ì •ë³´**

* **ì´ ì´ë¯¸ì§€ ìˆ˜:** 3,832ì¥
* **ì´ë¯¸ì§€ í•´ìƒë„:** 959 x 661 í”½ì…€
* **ë¼ì´ì„ ìŠ¤:** CC BY 4.0 (ì €ì‘ì í‘œì‹œ ë° ìˆ˜ì •ì‚¬í•­ ëª…ì‹œ í•„ìš”)
* **ì›ë³¸ ì´ë¯¸ì§€ ë³´ì¡´:** ë§ˆìŠ¤í¬ë‚˜ ë¼ë²¨ì˜ ì •ë°€ ì •ë ¬ì„ ìœ„í•´ ë‹¤ì–‘í•œ ì›ë³¸ ì´ë¯¸ì§€ í¬ê¸°ë„ í•¨ê»˜ ì œê³µ

### ğŸ“‚ **ë°ì´í„° êµ¬ì„±**

* **4ê°œì˜ ì£¼ìš” í´ë”**:

  * Trans-thalamic
  * Trans-ventricular
  * Trans-cerebellum
  * ê¸°íƒ€ íƒœì•„ ë¨¸ë¦¬ ì˜ìƒ
* ê° í´ë”ì—ëŠ”:

  * ì›ë³¸ ì´ë¯¸ì§€
  * í”½ì…€ë‹¹ mm ë‹¨ìœ„ë¥¼ ë‹´ì€ CSV íŒŒì¼
  * **11ê°€ì§€ í¬ë§·ì˜ í•˜ìœ„ í´ë”** (Cityscapes, YOLO, COCO ë“±)ë¥¼ í¬í•¨
* **ì‚¬ì „ í•™ìŠµ/ê²€ì¦ ë¶„í•  ì—†ìŒ**: ì—°êµ¬ìê°€ ì§ì ‘ ë¶„í•  ì„¤ì • ê°€ëŠ¥

### ğŸ§  **ì£¼ì„ í´ë˜ìŠ¤ ì •ë³´**

* **Brain (ë‡Œ):** 3,794ê±´
* **CSP (íˆ¬ëª…ì¤‘ê²©ì¡°):** 1,865ê±´
* **LV (ì¸¡ë‡Œì‹¤):** 1,512ê±´

### ğŸ“‘ **ì£¼ìš” íŠ¹ì§• ë° ì¥ì **

* **ìœ¤ë¦¬ì  ë°ì´í„° í™œìš©:** ìµëª…í™”ëœ ê³µê³µ ì´ë¯¸ì§€ ì‚¬ìš©, ê°œì¸ ì •ë³´ ë³´í˜¸ ì¤€ìˆ˜
* **ì¬í˜„ì„± ë³´ì¥:** ì£¼ì„ì, ê²€ì¦ ì ˆì°¨, í”¼ë“œë°± ê¸°ë¡ ë¬¸ì„œí™”
* **ì˜¤í”ˆ ì‚¬ì´ì–¸ìŠ¤ ì§€í–¥:** ììœ ë¡œìš´ í™œìš©ê³¼ ê³µë™ì—°êµ¬ ì¥ë ¤
* **ë‹¤ì–‘í•œ í™œìš© ê°€ëŠ¥ì„±:** ë¶„ë¥˜, ê°ì²´ íƒì§€, ë¶„í•  ë“± ë‹¤ì–‘í•œ ì»´í“¨í„° ë¹„ì „ ê³¼ì œì— ì í•©

### ğŸ¤ **í™œìš© ì‹œ ì£¼ì˜ì‚¬í•­ ë° í˜‘ì—…**

* ì‚¬ìš© ì‹œ **ì ì ˆí•œ ì¸ìš© ë° ì €ì‘ì í‘œì‹œ** í•„ìš”
* ë§ˆìŠ¤í¬ë‚˜ ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ì›ë³¸ ì´ë¯¸ì§€ì— ì •ë°€í•˜ê²Œ ë§¤í•‘í•  ê²½ìš°, **ì›ë³¸ ì‚¬ì´ì¦ˆ ì´ë¯¸ì§€ ì‚¬ìš© ê¶Œì¥**
* ë°ì´í„°ì…‹ ê´€ë ¨ ë¬¸ì˜: **[mahmood.phd@ieee.org](mailto:mahmood.phd@ieee.org)**

ì´ ë°ì´í„°ì…‹ì€ ì˜ë£Œ ì˜ìƒ ë¶„ì„ ì•Œê³ ë¦¬ì¦˜ì„ ì—°êµ¬í•˜ê³  í‰ê°€í•˜ëŠ” ë° ìµœì í™”ë˜ì–´ ìˆìœ¼ë©°, íŠ¹íˆ **íƒœì•„ ìƒì²´ ê³„ì¸¡, êµ¬ì¡° ë¶„í• , ê°ì²´ íƒì§€ ëª¨ë¸ ê°œë°œì— ë§¤ìš° ìœ ìš©í•œ ë¦¬ì†ŒìŠ¤**ì…ë‹ˆë‹¤.

---

## ëª¨ë¸ ì•„í‚¤í…ì³  
ë¬¼ë¡ ì´ì—ìš”! ì•„ë˜ëŠ” **PyTorch ê¸°ë°˜ UNet ì•„í‚¤í…ì²˜ ì„¤ê³„ ì˜ˆì‹œ**ì…ë‹ˆë‹¤. í•™ë¶€ ìˆ˜ì¤€ì—ì„œë„ ì´í•´í•˜ê³  í™œìš©í•  ìˆ˜ ìˆë„ë¡ **ëª¨ë“ˆí™” êµ¬ì¡°**ë¡œ ì„¤ê³„í–ˆìœ¼ë©°, ì´ ë°ì´í„°ì…‹(íƒœì•„ ë¨¸ë¦¬ ì´ˆìŒíŒŒ ì˜ìƒ ë¶„í• )ì— ë§ì¶° ì¶œë ¥ ì±„ë„ ìˆ˜ëŠ” í´ë˜ìŠ¤ ìˆ˜ì— ë§ê²Œ ì¡°ì •í•  ìˆ˜ ìˆì–´ìš”.

### âœ… UNet ì•„í‚¤í…ì²˜ ì˜ˆì‹œ (PyTorch)

```python
import torch
import torch.nn as nn
import torch.nn.functional as F

class DoubleConv(nn.Module):
    """(Conv => BN => ReLU) * 2"""
    def __init__(self, in_channels, out_channels):
        super(DoubleConv, self).__init__()
        self.conv = nn.Sequential(
            nn.Conv2d(in_channels, out_channels, 3, padding=1),
            nn.BatchNorm2d(out_channels),
            nn.ReLU(inplace=True),

            nn.Conv2d(out_channels, out_channels, 3, padding=1),
            nn.BatchNorm2d(out_channels),
            nn.ReLU(inplace=True)
        )

    def forward(self, x):
        return self.conv(x)


class UNet(nn.Module):
    def __init__(self, in_channels=1, out_channels=3):
        super(UNet, self).__init__()

        self.encoder1 = DoubleConv(in_channels, 64)
        self.pool1 = nn.MaxPool2d(2)

        self.encoder2 = DoubleConv(64, 128)
        self.pool2 = nn.MaxPool2d(2)

        self.encoder3 = DoubleConv(128, 256)
        self.pool3 = nn.MaxPool2d(2)

        self.encoder4 = DoubleConv(256, 512)
        self.pool4 = nn.MaxPool2d(2)

        self.bottleneck = DoubleConv(512, 1024)

        self.upconv4 = nn.ConvTranspose2d(1024, 512, kernel_size=2, stride=2)
        self.decoder4 = DoubleConv(1024, 512)

        self.upconv3 = nn.ConvTranspose2d(512, 256, kernel_size=2, stride=2)
        self.decoder3 = DoubleConv(512, 256)

        self.upconv2 = nn.ConvTranspose2d(256, 128, kernel_size=2, stride=2)
        self.decoder2 = DoubleConv(256, 128)

        self.upconv1 = nn.ConvTranspose2d(128, 64, kernel_size=2, stride=2)
        self.decoder1 = DoubleConv(128, 64)

        self.final_conv = nn.Conv2d(64, out_channels, kernel_size=1)

    def forward(self, x):
        # Encoder
        e1 = self.encoder1(x)
        e2 = self.encoder2(self.pool1(e1))
        e3 = self.encoder3(self.pool2(e2))
        e4 = self.encoder4(self.pool3(e3))

        # Bottleneck
        b = self.bottleneck(self.pool4(e4))

        # Decoder with skip connections
        d4 = self.upconv4(b)
        d4 = self.decoder4(torch.cat((d4, e4), dim=1))

        d3 = self.upconv3(d4)
        d3 = self.decoder3(torch.cat((d3, e3), dim=1))

        d2 = self.upconv2(d3)
        d2 = self.decoder2(torch.cat((d2, e2), dim=1))

        d1 = self.upconv1(d2)
        d1 = self.decoder1(torch.cat((d1, e1), dim=1))

        return self.final_conv(d1)
```

### ğŸ§ª ì£¼ìš” ì„¤ì •

| í•­ëª©          | ê°’                                               |
| ----------- | ----------------------------------------------- |
| **ì…ë ¥ ì±„ë„ ìˆ˜** | 1 (í‘ë°± ì´ˆìŒíŒŒ ì˜ìƒ)                                   |
| **ì¶œë ¥ ì±„ë„ ìˆ˜** | 3 (Brain, CSP, LV ê°ê° í´ë˜ìŠ¤ ë§ˆìŠ¤í¬)                   |
| **ì¶œë ¥ í˜•íƒœ**   | shape = `(batch, 3, H, W)` â†’ softmax í›„ í´ë˜ìŠ¤ ë¶„í•    |
| **ì†ì‹¤ í•¨ìˆ˜**   | CrossEntropyLoss ë˜ëŠ” DiceLoss (segmentationì— ì í•©) |
| **í‰ê°€ì§€í‘œ**    | Dice Coefficient, IoU, Accuracy ë“±               |


### ğŸ§± ì „ì²´ êµ¬ì¡° ìš”ì•½

```
ì…ë ¥ (1ì±„ë„) â†’ Encoder (Downsampling) â†’ Bottleneck â†’ Decoder (Upsampling + Skip) â†’ ì¶œë ¥ (3ì±„ë„ ë¶„í• ë§µ)
```

í•„ìš”í•˜ë‹¤ë©´ ë‹¤ìŒ ë‹¨ê³„ë„ ë„ì™€ì¤„ ìˆ˜ ìˆì–´ìš”:

* í•™ìŠµ ë£¨í”„ (`train()`, `validate()` í•¨ìˆ˜ êµ¬ì¡°)
* ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸ (`Albumentations` or `torchvision.transforms`)
* ì‹œê°í™” ì½”ë“œ (ì˜ˆ: ë§ˆìŠ¤í¬ overlay, IoU ê·¸ë˜í”„ ë“±)

ì´ ëª¨ë¸ì„ ê¸°ë°˜ìœ¼ë¡œ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ ì¢‹ì€ ê²°ê³¼ê°€ ë‚˜ì˜¬ ê±°ì˜ˆìš”. ë” êµ¬ì²´ì ì¸ ë„ì›€ë„ í•„ìš”í•˜ë©´ í¸í•˜ê²Œ ë§í•´ì¤˜ìš”!

